(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{473:function(e,t){},476:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectiSerialCmp=void 0;var a=O(n(22)),l=O(n(146)),i=O(n(80)),o=O(n(27)),r=O(n(164)),s=O(n(38)),c=O(n(3)),u=O(n(9)),d=O(n(2)),f=O(n(7)),p=O(n(5)),h=O(n(6)),m=O(n(12)),v=O(n(1)),C=n(14),y=O(n(147)),E=n(91),g=O(n(35)),N=O(n(21)),T=O(n(15)),S=O(n(16)),k=O(n(165));function O(e){return e&&e.__esModule?e:{default:e}}var I=T.default.CONNECT_STATUS,b=T.default.SCAN_STATUS,_=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));return n.getEditingTarget=function(){try{var e=(0,E.editingTarget)();n.option=e.config.options.connect.serialport}catch(e){}},n.handleChange=function(e){n.props.current(e)},n.handleChangeIsShowAll=function(e){var t=n.props.connect.type;n.props.setIsShowAll(e.target.checked),n.props.discovery(t)},n.handleConnect=function(){var e=n.props,t=e.connect,a=e.device,l=e.connectDevice,i=t.type,o=t.current,r=t.scanData;if(null==o&&m.default.isEmpty(r[i])){var u=n.props.intlr;s.default.warning(u.messages["CONNECT.CHOOSE.SERIAL"])}else{var d=m.default.find(r[i],{comName:o})||r[i][0],f=115200;try{if(m.default.isNumber(Number(n.option.baudRate))){[1200,9600,19200,38400,43e3,56e3,57600,115200,230400].indexOf(Number(n.option.baudRate))>=0&&(f=Number(n.option.baudRate))}}catch(e){}l(a,i,(0,c.default)({baudRate:f},d),function(){var e=n.props.intlr;s.default.success(e.messages["CONNECT.MESSAGE.SUCCESS"]),S.default.replace("/")},function(){var e=n.props.intlr;s.default.error(e.messages["CONNECT.MESSAGE.FAIL"]),clearInterval(n.discoveryTimer),n.discoveryTimer=null})}},n.discoveryTimer=null,n.option=null,n}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentWillMount",value:function(){var e=this.props.connect.type;this.props.setIsShowAll(!1),this.props.discovery(e),this.loopDiscovery(e),this.getEditingTarget()}},{key:"componentWillUnmount",value:function(){this.discoveryTimer&&clearInterval(this.discoveryTimer),this.discoveryTimer=null}},{key:"allowLoopScan",value:function(){return!this.isConnecting()||!this.isConnectedSucc()}},{key:"loopDiscovery",value:function(e){var t=this,n=this.props.connect;e===n.type&&(this.discoveryTimer=setInterval(function(){var n=t.props.status;t.discoveryTimer&&t.allowLoopScan()&&n!==I.NOT_SERVICE&&t.props.discovery(e)},5e3))}},{key:"isScaning",value:function(){var e=this.props.connect,t=e.scanStatus,n=e.scanData,a=e.type;return t===b.SCANNING&&m.default.isEmpty(n[a])}},{key:"isConnecting",value:function(){return this.props.connect.status===I.CONNECTING}},{key:"isConnectedSucc",value:function(){return this.props.connect.status===I.CONNECT_SUCCESS}},{key:"isConnected",value:function(){return this.props.connect.status===I.CONNECTED}},{key:"enableConnectBtn",value:function(){var e=this.props.connect,t=e.scanData,n=e.type;return this.isScaning()||m.default.isEmpty(t[n])}},{key:"placeholder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"100%";return v.default.createElement(r.default,{style:{width:e,margin:"0 auto"},defaultValue:"",key:"placeholder_select",disabled:!0},this.placeholderOption())}},{key:"optionPrefix",value:function(){return v.default.createElement(o.default,{type:"loading",style:{marginRight:"1em",color:"#46B5FF",border:"1px solid #ddd",borderRadius:"50%"}})}},{key:"placeholderOption",value:function(){var e=this.props.intlr;return v.default.createElement(r.default.Option,{value:"",disabled:!0},this.optionPrefix(),e.messages["SCANING.SERIAL"])}},{key:"emptyOption",value:function(){var e=this.props.intlr;return v.default.createElement(r.default.Option,{value:"",disabled:!0},e.messages["CONNECT.LIST.EMPTY"])}},{key:"scanResultOptions",value:function(){var e=this,t=this.props,n=t.connect,a=t.intlr,l=n.scanData,i=n.devices,o=n.type,s=[];return l&&l[o]&&(s=l[o]),m.default.isEmpty(s)?this.emptyOption():s.map(function(t,n){var l=m.default.some(i,{address:t.address,connected:!0});return v.default.createElement(r.default.Option,{key:n,value:t.comName,disabled:e.isConnecting()},t.comName,l&&v.default.createElement("small",{className:"connected-text"},a.messages["CONNECT.CONNECTED"]))})}},{key:"scanResult",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"100%";return v.default.createElement(r.default,{dropdownMatchSelectWidth:!0,defaultActiveFirstOption:!1,defaultValue:this.props.connect.current,value:this.props.connect.current,onChange:this.handleChange,disabled:this.enableConnectBtn(),style:{width:e,margin:"0 auto"},key:"scan_result"},this.scanResultOptions())}},{key:"result",value:function(e){return this.scanResult(e)}},{key:"iconCol",value:function(){return v.default.createElement(i.default.Item,{className:"icon-col"},v.default.createElement("i",{className:"mblock-icon icon-tishilianjieUSBshebei"}))}},{key:"content",value:function(e){var t=this.props.connect.scanData[T.default.CONNECT_TYPE.SERIAL]||[];return m.default.isEmpty(t)&&this.isScaning()?this.placeholder(e):this.result(e)}},{key:"getLink",value:function(){var e=this.props.intlr;return N.default.link.connect_faq[e.langKey]}},{key:"render",value:function(){var e=this.props.intlr,t=this.option&&this.option.tips&&this.option.tips.fail||[],n=this.option&&this.option.helpLink||"";return v.default.createElement(i.default,null,this.iconCol(),v.default.createElement(i.default.Item,null,v.default.createElement(l.default,{onChange:this.handleChangeIsShowAll},v.default.createElement("span",{className:"connect-all-text"},e.messages["SHOW.CONNECTABLE.DEVICES.TEXT"]))),v.default.createElement(i.default.Item,null,this.content()),v.default.createElement(i.default.Item,null,v.default.createElement(a.default,{className:"btn-connect",type:"primary",loading:this.isConnecting(),disabled:this.enableConnectBtn(),onClick:this.handleConnect},e.messages["CONNECT.BUTTON.TEXT"]),v.default.createElement("ul",{className:"helpTip"},t.map(function(e,t){return v.default.createElement("li",{key:t},(0,k.default)(e))})," ",n&&v.default.createElement("li",null,e.messages["CONNECT.PROBLEM.TIP"],v.default.createElement("a",{href:n,rel:"nofollow me noopener noreferrer",target:"_blank",onClick:function(e){return g.default.openLink(e,n)}},e.messages["CONNECT.HELPLINK.TEXT"])))))}}]),t}(v.default.Component);t.default=(0,C.connect)(function(e){return{intlr:e.intlr,connect:e.connect}},function(e){return{discovery:function(t){return e(y.default.discovery(t))},current:function(t){return e(y.default.current(t))},connectDevice:function(t,n,a,l,i){e(y.default.connect(t,n,a,l,i))},setIsShowAll:function(t){return e(y.default.setIsShowAll(t))}}})(_);t.ConnectiSerialCmp=_},790:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=O(n(22)),l=O(n(146)),i=O(n(80)),o=O(n(27)),r=O(n(164)),s=O(n(38)),c=O(n(3)),u=O(n(9)),d=O(n(2)),f=O(n(7)),p=O(n(5)),h=O(n(6)),m=O(n(12)),v=O(n(1)),C=n(14),y=O(n(147)),E=n(91),g=O(n(15)),N=O(n(35)),T=O(n(16)),S=O(n(21)),k=O(n(165));function O(e){return e&&e.__esModule?e:{default:e}}var I=g.default.CONNECT_STATUS,b=g.default.SCAN_STATUS,_=function(e){function t(e){(0,d.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));return n.getEditingTarget=function(){try{var e=(0,E.editingTarget)();n.option=e.config.options.connect.ble}catch(e){}},n.handleChange=function(e){n.props.current(e)},n.handleChangeIsShowAll=function(e){var t=n.props.connect.type;n.props.setIsShowAll(e.target.checked),n.props.discovery(t)},n.handleConnect=function(){var e=n.props,t=e.connect,a=e.device,l=e.connectDevice,i=t.type,o=t.current,r=t.scanData;if(null==o&&m.default.isEmpty(r[i])){var u=n.props.intlr;s.default.warning(u.messages["CONNECT.CHOOSE.BLE"])}else{var d=m.default.find(r[i],{comName:o})||r[i][0];l(a,i,(0,c.default)({},d,n.option),function(){var e=n.props.intlr;s.default.success(e.messages["CONNECT.MESSAGE.SUCCESS"]),T.default.replace("/")},function(){var e=n.props.intlr;s.default.error(e.messages["CONNECT.MESSAGE.FAIL"]),clearInterval(n.discoveryTimer),n.discoveryTimer=null,n.loopDiscovery(i)})}},n.ableSignal=function(e){return e>-45?"xinhaogao":e<-90?"xinhaodi":"xinhaozhong"},n.discoveryTimer=null,n.isFirstDiscover=!0,n.option=null,n}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentWillMount",value:function(){var e=this.props.connect.type;this.props.setIsShowAll(!1),this.props.discovery(e),this.loopDiscovery(e),this.getEditingTarget()}},{key:"componentWillUnmount",value:function(){this.discoveryTimer&&clearInterval(this.discoveryTimer),this.discoveryTimer=null}},{key:"allowLoopScan",value:function(){return!this.isConnecting()||!this.isConnectedSucc()}},{key:"loopDiscovery",value:function(e){var t=this;this.discoveryTimer=setInterval(function(){if(e!==T.default.location.pathname.split("/")[2])return clearInterval(t.discoveryTimer),void(t.discoveryTimer=null);var n=t.props.status;t.discoveryTimer&&t.allowLoopScan()&&n!==I.NOT_SERVICE&&t.props.discovery(e)},3e3)}},{key:"isScaning",value:function(){var e=this.props.connect,t=e.scanStatus,n=e.scanData,a=e.type;return t===b.SCANNING&&m.default.isEmpty(n[a])}},{key:"isConnecting",value:function(){return this.props.connect.status===I.CONNECTING}},{key:"isConnectedSucc",value:function(){return this.props.connect.status===I.CONNECT_SUCCESS}},{key:"isConnected",value:function(){return this.props.connect.status===I.CONNECTED}},{key:"enableConnectBtn",value:function(){var e=this.props.connect,t=e.scanData,n=e.type;return this.isScaning()||m.default.isEmpty(t[n])}},{key:"placeholder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"100%";return v.default.createElement(r.default,{style:{width:e,margin:"0 auto"},defaultValue:"",key:"placeholder_select",disabled:!0},this.placeholderOption())}},{key:"optionPrefix",value:function(){return v.default.createElement(o.default,{type:"loading",style:{marginRight:"1em",color:"#46B5FF",border:"1px solid #ddd",borderRadius:"50%"}})}},{key:"placeholderOption",value:function(){var e=this.props.intlr;return v.default.createElement(r.default.Option,{value:"",disabled:!0},this.optionPrefix(),e.messages["SCANING.BLE"])}},{key:"emptyOption",value:function(){var e=this.props.intlr;return v.default.createElement(r.default.Option,{value:"",disabled:!0},e.messages["CONNECT.LIST.EMPTY"])}},{key:"iconCol",value:function(){return v.default.createElement(i.default.Item,{className:"icon-col"},v.default.createElement("i",{className:"mblock-icon icon-tishilanyalianjieshebei"}))}},{key:"content",value:function(e){var t=this.props.connect.scanData[g.default.CONNECT_TYPE.BLE]||[];if(!m.default.isEmpty(t)&&this.isFirstDiscover)this.isFirstDiscover=!1;else if(m.default.isEmpty(t)&&this.isScaning()||this.isFirstDiscover)return this.placeholder(e);return this.result(e)}},{key:"scanResultOptions",value:function(){var e=this,t=this.props.connect,n=t.scanData,a=t.type,l=[];return n&&n[a]&&(l=n[a]),m.default.isEmpty(l)?this.emptyOption():l.map(function(t,n){return v.default.createElement(r.default.Option,{key:n,className:"connect-option",value:t.comName,disabled:e.isConnecting()},v.default.createElement("div",{className:"connect-option-inner"},v.default.createElement("span",{title:t.localName},t.localName),v.default.createElement("i",{className:"mblock-icon icon-xinhaogao "+e.ableSignal(t.rssi)})))})}},{key:"scanResult",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"100%";return v.default.createElement(r.default,{dropdownMatchSelectWidth:!0,defaultActiveFirstOption:!1,defaultValue:this.props.connect.current,value:this.props.connect.current,onChange:this.handleChange,disabled:this.enableConnectBtn(),style:{width:e,margin:"0 auto"},key:"scan_result"},this.scanResultOptions())}},{key:"result",value:function(){return v.default.createElement("section",{className:"ble-select-wrap"},this.scanResult(),this.isScaning()&&v.default.createElement(o.default,{type:"loading"}))}},{key:"getLink",value:function(){var e=this.props.intlr;return S.default.link.connect_faq[e.langKey]}},{key:"render",value:function(){var e=this.props.intlr,t=this.option&&this.option.tips&&this.option.tips.fail||[],n=this.option&&this.option.helpLink||"";return v.default.createElement(i.default,null,this.iconCol(),v.default.createElement(i.default.Item,null,v.default.createElement(l.default,{onChange:this.handleChangeIsShowAll},v.default.createElement("span",{className:"connect-all-text"},e.messages["SHOW.CONNECTABLE.DEVICES.TEXT"]))),v.default.createElement(i.default.Item,null,this.content()),v.default.createElement(i.default.Item,null,v.default.createElement(a.default,{className:"btn-connect",type:"primary",loading:this.isConnecting(),disabled:this.enableConnectBtn(),onClick:this.handleConnect},e.messages["CONNECT.BUTTON.TEXT"]),v.default.createElement("ul",{className:"helpTip"},t.map(function(e,t){return v.default.createElement("li",{key:t},(0,k.default)(e))})," ",n&&v.default.createElement("li",null,e.messages["CONNECT.PROBLEM.TIP"],v.default.createElement("a",{href:n,rel:"nofollow me noopener noreferrer",target:"_blank",onClick:function(e){return N.default.openLink(e,n)}},e.messages["CONNECT.HELPLINK.TEXT"])))))}}]),t}(v.default.Component);t.default=(0,C.connect)(function(e){return{intlr:e.intlr,connect:e.connect}},function(e){return{discovery:function(t){return e(y.default.discovery(t))},current:function(t){return e(y.default.current(t))},connectDevice:function(t,n,a,l,i){e(y.default.connect(t,n,a,l,i))},setIsShowAll:function(t){return e(y.default.setIsShowAll(t))}}})(_)},791:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(9)),l=d(n(2)),i=d(n(7)),o=d(n(5)),r=d(n(6)),s=d(n(1)),c=n(476),u=n(489);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,r.default)(t,e),(0,i.default)(t,[{key:"iconCol",value:function(){return null}},{key:"content",value:function(){return s.default.createElement("section",{className:"hid-description"},s.default.createElement(u.FormattedHTMLMessage,{id:"CONNECT.HID.DESCRIPTION"}))}}]),t}(c.ConnectiSerialCmp);t.default=(0,u.injectIntl)(f)},826:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(28)),l=T(n(198)),i=T(n(221)),o=T(n(3)),r=T(n(9)),s=T(n(2)),c=T(n(7)),u=T(n(5)),d=T(n(6)),f=T(n(12)),p=T(n(1)),h=n(90),m=n(14),v=n(18),C=T(n(16)),y=T(n(15)),E=T(n(476)),g=T(n(791)),N=T(n(790));function T(e){return e&&e.__esModule?e:{default:e}}n(473);var S=y.default.CONNECT_TYPE,k=function(e){function t(e){(0,s.default)(this,t);var n=(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));n.handleCancel=function(){C.default.replace("/")};var a=n.props,l=a.match,i=a.intlr,c=C.default.location.search;return n.device={deviceId:(0,v.getQueryString)(c,"deviceId"),name:(0,v.getQueryString)(c,"name")},n.connectConfig=[{type:S.SERIAL,name:i.messages["CONNECT.SERIAL"],path:l.path+"/"+S.SERIAL,component:E.default},{type:S.HID,name:i.messages["CONNECT.HID"],path:l.path+"/"+S.HID,component:g.default},{type:S.BLE,name:i.messages["CONNECT.BLE"],path:l.path+"/"+S.BLE,component:N.default}],n.state=(0,o.default)({},n._getCurrentConnectConfig(),{animated:!1}),n}return(0,d.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=C.default.location;this.isNoType&&C.default.replace(this.state.path+e.search)}},{key:"_getDefaultPath",value:function(){var e=this.props,t=e.match,n=e.location,a=e.connect;return this.isNoType=n.pathname===t.url,this.isNoType?t.path+"/"+a.type:n.pathname}},{key:"_getCurrentConnectConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._getDefaultPath();return f.default.find(this.connectConfig,{path:e})||this.connectConfig[0]}},{key:"handleSwitchTab",value:function(e){var t=this.props,n=t.location,a=t.switchConnectType,l=this._getCurrentConnectConfig(e);a(l.type),C.default.replace(l.path+n.search)}},{key:"getTabPanes",value:function(){var e=this,t=[];return this.connectConfig.map(function(n){t.push(p.default.createElement(i.default.TabPane,{tab:n.name,key:n.path},e.singleConnectType(n)))}),t}},{key:"singleConnectType",value:function(e){var t=this,n=e||this.connectConfig[0];return p.default.createElement(l.default,{className:"connect-page"},p.default.createElement(h.Route,{path:n.path,render:function(){return p.default.createElement(n.component,{device:t.device})}}))}},{key:"multiConnectType",value:function(){return p.default.createElement(i.default,{tabBarStyle:{textAlign:"center",marginBottom:"24px"},animated:this.state.animated,defaultActiveKey:this.state.path,activeKey:this.state.path,onChange:this.handleSwitchTab.bind(this)},this.getTabPanes())}},{key:"render",value:function(){var e=this.props.intlr;return p.default.createElement(a.default,{className:"small-modal",width:"100%",visible:!0,title:e.messages["CONNECT.TITLE"],maskClosable:!1,keyboard:!1,onCancel:this.handleCancel,footer:null},this.singleConnectType())}}]),t}(p.default.Component);t.default=(0,m.connect)(function(e){return{intlr:e.intlr,connect:e.connect}})(k)}}]);