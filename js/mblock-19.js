(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{785:function(e,t,a){e.exports=a.p+"static/imgs/exts-default.png"},786:function(e,t,a){e.exports=a.p+"static/imgs/null_waitDev.svg"},787:function(e,t){},817:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=P(a(28)),l=P(a(22)),s=P(a(816)),i=P(a(78)),r=P(a(163)),o=P(a(162)),d=P(a(815)),c=P(a(478)),u=P(a(814)),m=P(a(27)),f=P(a(73)),p=P(a(38)),E=P(a(9)),g=P(a(2)),h=P(a(7)),v=P(a(5)),N=P(a(6)),y=P(a(12)),T=P(a(1)),C=a(14),O=P(a(16)),k=a(197),x=a(91),I=P(a(63)),b=P(a(21)),L=a(18),w=a(196);a(787);var S=P(a(786)),D=P(a(785)),A=P(a(35));function P(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e){(0,g.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,E.default)(t)).call(this,e));return a.handleCancel=function(){O.default.replace("/")},a.handleAdd=function(e){e.installing||a.props.add(e,function(){!0!==e.device&&p.default.success(a.props.intlr.messages["EXTENSION.ADDED"],2),O.default.replace("/")},function(){p.default.error(a.props.intlr.messages["EXTENSION.INSTALL.FAIL"],2)})},a.handleRemove=function(e){var t=a.props.intlr;a.props.remove(e.id,function(){p.default.success(t.messages["EXTENSION.REMOVED"],2)},function(){p.default.warn(t.messages["EXTENSION.REMOVED.FAIL"],2)}),O.default.replace("/")},a.getFirstKey=function(e){return e&&y.default.isPlainObject(e)&&(0,f.default)(e)[0]||""},a.handleError=function(){a.setState({src:D.default})},a.handleVisibleChange=function(e,t,n){var l=a.props.intlr;e&&(0,x.hasUseExtBlocks)(t.id&&t.id.toLowerCase())?(a.setState({visible:!1,confirmIdx:n}),p.default.warn(l.messages["EXTENSION.REMOVED.FAIL"],2)):e?a.setState({visible:!0,confirmIdx:n}):a.setState({visible:e,confirmIdx:n})},a.handleLinkClick=function(e){return function(t){return t.stopPropagation(),A.default.openLink(t,e)}},a.state={confirmIdx:-1,visible:!1,condition:!0,isEmptyData:!1},a}return(0,N.default)(t,e),(0,h.default)(t,[{key:"componentWillMount",value:function(){(0,this.props.list)("common")}},{key:"emptyContent",value:function(){var e=this.props.intlr;return T.default.createElement("div",{className:"empty-wrapper"},T.default.createElement("img",{src:S.default}),T.default.createElement("span",null,e.messages["EXTENSION.EMPTY"]))}},{key:"itemsContent",value:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.props.intlr,i=this.state,r=i.visible,f=i.confirmIdx,p=s.langKey,E=y.default.sortBy(e,"sortId");if(n)return this.emptyContent();var g=E.length>1?"item":"item single-item";return E.map(function(e,n){var i=e.name.en||e.name.zh,E=e.description.en||e.description.zh,h=y.default.isPlainObject(e.name)?e.name[p]||i:e.name,v=y.default.isPlainObject(e.description)?e.description[p]||E:e.description,N=t.find(function(t){return t.toLowerCase()===e.id.toLowerCase()}),C=!0===e.userCustom,O=void 0;O=e.originVersion?(0,L.safeHttps)((0,w.getExtResPath)(e.iconURL,e.id)):e.coverURL;var k=(l?"preview_":"")+e.id+"_"+n,x=e.platform,I=e.homepage,b=(0,w.isSupportPlatform)(x,"mblockpc"),S=(0,w.isSupportPlatform)(x,"mblockweb"),D=(0,w.isSupportPlatform)(x,"mblockapp");x&&x.length||(b=!0,S=!0,D=!0);return S?("add",T.default.createElement(o.default,{style:{marginBottom:"1rem"},key:k,className:g},T.default.createElement(d.default,{style:{display:"flex",flexDirection:"column",height:"100%",cursor:"default"},bodyStyle:{paddingTop:"1rem",paddingRight:"8px",paddingBottom:"1rem",paddingLeft:"1rem",flex:1},className:"extension-item",cover:T.default.createElement("img",{alt:h,src:O,onError:a.handleError}),actions:[N?T.default.createElement(u.default,{title:s.messages["EXTENSION.REMOVED.CONFIRM"],visible:r&&f===k,okText:s.messages["BUTTON.OK.TEXT"],onVisibleChange:function(t){return a.handleVisibleChange(t,e,k)},cancelText:s.messages["BUTTON.CANCEL.TEXT"],onConfirm:a.handleRemove.bind(a,e)},T.default.createElement("span",{className:"ext-action-trigger delete"},T.default.createElement(m.default,{key:"delete",type:"close"}),T.default.createElement("span",{style:{paddingLeft:"4px"}},s.messages["BUTTON.DELETE"]))):T.default.createElement("span",{className:"ext-action-trigger add",onClick:a.handleAdd.bind(a,e)},T.default.createElement(m.default,{key:"add",type:e.installing?"loading":"plus"}),T.default.createElement("span",{style:{paddingLeft:"4px"}},e.installing,s.messages["BUTTON.ADD"]))],hoverable:!0},T.default.createElement(d.default.Meta,{className:"item-card-title",title:T.default.createElement("div",{className:"title-wrapper"},T.default.createElement("div",{className:"title"},I?T.default.createElement(c.default,{content:s.messages["DEVICE.MOREINFO"],placement:"rightTop",overlayClassName:"mblock-popover-no-arrow"},T.default.createElement("a",{className:"name",onClick:a.handleLinkClick(I)},h,C?T.default.createElement("small",{style:{color:"#ddd"}}," (",e.version,")"):null)):T.default.createElement("span",{className:"name no-popover-name"},h,C?T.default.createElement("small",{style:{color:"#ddd"}}," (",e.version,")"):null)),T.default.createElement("div",{className:"author-wrapper"},T.default.createElement("div",{className:"author-inner"},T.default.createElement(c.default,{content:1===e.isOfficialDev||void 0===e.isOfficialDev?s.messages["EXTENSION.DEVELOPER.TIP.OFFICIAL"]:s.messages["EXTENSION.DEVELOPER.TIP.UNOFFICIAL"],placement:"bottom",overlayClassName:"mblock-popover-no-arrow"},e.isDev&&!e.createdByName?null:T.default.createElement("span",{className:"author"},s.messages["EXTENSION.DEVELOPER"]+": "+(e.createdByName||"mBlock")))),T.default.createElement("div",{className:"platform-wrapper"},b&&T.default.createElement("i",{className:"mblock-icon icon-diannao"}),S&&T.default.createElement("i",{className:"mblock-icon icon-wangye"}),D&&T.default.createElement("i",{className:"mblock-icon icon-shouji"})))),description:v})))):null})}},{key:"userItemsContent",value:function(e,t,a){return this.itemsContent(e,t,a,!0)}},{key:"content",value:function(){var e=this.props.extension,t=e.installed,a=e.exts,n=void 0===a?[]:a,l=e.userExts,s=void 0===l?[]:l;t=I.default.instance.getAllExtensionIds()||t;var i=(0,x.editingTarget)(),o=function(e){return y.default.filter(e,function(e){return y.default.isArray(e.targets)?-1!==e.targets.indexOf(i.id)||!(!e.remoteTargets||-1===e.remoteTargets.indexOf(i.id))&&(delete e.originVersion,!0):(e.targets||"").toLowerCase()===(i.id||"").toLowerCase()})};n=o(n),s=o(s);var d=y.default.isEmpty(n)&&y.default.isEmpty(s);return T.default.createElement(r.default,{type:"flex",gutter:16,className:"content-row extension-list",style:{height:"auto"}},this.userItemsContent(s,t,d),this.itemsContent(n,t,d))}},{key:"handleChange",value:function(e,t){var a=this.state.selectedTags,n=t?[].concat((0,i.default)(a),[e]):a.filter(function(t){return t!==e});this.setState({selectedTags:n})}},{key:"tags",value:function(){var e=this;if("common"===this.type){var t=this.state.selectedTags,a=this.props.extension;return T.default.createElement("div",{style:{marginBottom:"1rem"}},T.default.createElement("h6",{style:{marginRight:8,display:"inline"}},"分类:"),a.tags.map(function(a){return T.default.createElement(s.default.CheckableTag,{key:a,checked:t.indexOf(a)>-1,onChange:function(t){return e.handleChange(a,t)}},a)}))}}},{key:"footerContent",value:function(){var e=this.props,t=e.intlr,a=e.extension,n=a.exts,s=void 0===n?[]:n,i=a.userExts,r=void 0===i?[]:i;return T.default.createElement("div",{className:"extension-modal-footer"},T.default.createElement("a",{className:"to-develop",onClick:this.handleLinkClick(b.default.link.extBuild_homePage.zh)},t.messages["EXTENSION.BECOME.DEVELOPER"]),y.default.isEmpty(s)&&y.default.isEmpty(r)?T.default.createElement(l.default,{type:"primary",onClick:this.handleCancel},t.messages["BUTTON.IKNOW.TEXT"]):T.default.createElement(l.default,{type:"primary",ghost:!0,onClick:this.handleCancel},t.messages["BUTTON.CANCEL.TEXT"]))}},{key:"render",value:function(){var e=this.props.intlr;return T.default.createElement(n.default,{width:"960px",visible:!0,className:"extension-modal",title:e.messages["EXTENSION.TITLE"],onCancel:this.handleCancel,footer:this.footerContent()},this.content())}}]),t}(T.default.Component);t.default=(0,C.connect)(function(e){return{intlr:e.intlr,extension:e.extension}},function(e){return{add:function(t,a,n){return e(k.Actions.add(t,a,n))},list:function(t){return e(k.Actions.list(t,!1))},remove:function(t,a,n){return e(k.Actions.remove(t,a,n))}}})(R)}}]);