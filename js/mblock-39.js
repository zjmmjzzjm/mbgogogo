(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{795:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(a(80)),l=m(a(22)),o=m(a(9)),r=m(a(2)),i=m(a(7)),s=m(a(5)),u=m(a(6)),c=m(a(1)),d=a(14),f=m(a(21));function m(e){return e&&e.__esModule?e:{default:e}}var g=[{key:"qq",icon:"qq",url:f.default.social.qq},{key:"wechat",icon:"wechat",url:f.default.social.wechat}],h=[{key:"google",icon:"google",url:f.default.social.google}],E=function(e){function t(){var e,a,n,l;(0,r.default)(this,t);for(var i=arguments.length,u=Array(i),c=0;c<i;c++)u[c]=arguments[c];return a=n=(0,s.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(u))),n.handleClick=function(e){window.open(e)},l=a,(0,s.default)(n,l)}return(0,u.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this.props,t=e.intlr,a=e.isInternational,o=a?h:g,r=a?"en":"zh",i=f.default.link.mblock_web[r].split("index.html")[0];return c.default.createElement(n.default.Item,{className:"social-login form-item-last"},c.default.createElement("div",{className:"social-login-header"},c.default.createElement("span",{className:"text"},t.messages["OTHER.LOGIN"])),c.default.createElement("div",{className:"social-login-items"},o.map(function(e){return c.default.createElement("a",{key:e.key,onClick:function(){return window.open(e.url.format(i+"auth.html"),"myWindow","width=600, height=600")},rel:"nofollow noopener noreferrer",target:"_blank"},c.default.createElement(l.default,{shape:"circle",icon:e.icon,className:"social-login-item"}))})))}}]),t}(c.default.Component);t.default=(0,d.connect)(function(e){return{intlr:e.intlr}})(E)},837:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=L(a(28)),l=L(a(22)),o=L(a(80)),r=L(a(77)),i=L(a(40)),s=L(a(3)),u=L(a(9)),c=L(a(2)),d=L(a(7)),f=L(a(5)),m=L(a(6)),g=L(a(1)),h=a(14),E=L(a(87)),p=L(a(72)),v=L(a(16)),M=a(18),I=a(32),k=L(a(35)),N=L(a(21)),T=L(a(795));function L(e){return e&&e.__esModule?e:{default:e}}var S=function(e){function t(e){(0,c.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));return a.saveEl=function(e){e&&(a.focusEl=e,a.focusTimer=setTimeout(function(){a.focusEl&&a.props.history.location.pathname===(0,M.parseRoute)("/login")&&a.focusEl.focus()}))},a.handleCancel=function(){v.default.replace((0,M.parseRoute)("/"))},a.handleChange=function(e){var t=e.target.value;a.setState((0,s.default)({emailNum:t},a.validateEmailNum(t)))},a.validateEmailNum=function(e){var t=a.props.intlr;return e.trim()?!(0,I.isInternational)()&&/^[0-9a-zA-Z]*$/g.test(e)&&9===e.length?{validateStatus:"success",errorMsg:null}:e.length>100?{validateStatus:"error",errorMsg:t.messages["FORM.FIELD.EMAIL.OVER.TYPE.MSG"]}:(0,M.isEmailAccount)(e)?{validateStatus:"success",errorMsg:null}:{validateStatus:"error",errorMsg:t.messages[(0,I.isInternational)()?"FORM.FIELD.EMAIL.ONLY.TYPE.MSG":"FORM.FIELD.EMAIL.TYPE.MSG"]}:{validateStatus:"error",errorMsg:t.messages[(0,I.isInternational)()?"FORM.FIELD.EMAIL.ONLY.TYPE.MSG":"FORM.FIELD.EMAIL.TYPE.MSG"]}},a.handleNext=function(e){e.preventDefault();var t=a.state,n=t.errorMsg,l=t.emailNum;n||a.props.submit(l,a.successCb,a.failCb)},a.successCb=function(){var e=a.props.intlr,t=a.state.emailNum;/^[0-9a-zA-Z]*$/g.test(t)&&9===t.length?a.setState({validateStatus:"error",errorMsg:e.messages["FORM.FIELD.EMAIL.TYPE.MSG"]}):(0,I.isInternational)()?v.default.push((0,M.parseRoute)("/age")):v.default.replace((0,M.parseRoute)("/login/registerPwd"))},a.failCb=function(e){var t=a.props.intlr,n=e.code;10001===n?a.setState({validateStatus:"error",errorMsg:t.messages["FORM.FIELD.EMAIL.TYPE.MSG"]}):10002===n?v.default.push((0,M.parseRoute)("/login/loginPwd")):99999===n&&M.showErrorMessage.bind(a)("MSG.99999")},a.changeMode=function(){a.startTransitionAnimation().then(function(){var e=a.props.changeMode;a.setState({emailNum:"",validateStatus:"",errorMsg:""}),e(!(0,I.isInternational)())})},a.renderTitle=function(){var e=a.props.intlr;return g.default.createElement("div",{className:"title-tac"},e.messages["MBLOCK.TEXT"])},a.state={emailNum:"",validateStatus:"",errorMsg:""},a.focusEl=null,a.focusTimer=null,a}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.account,a=void 0===t?{}:t,n=e.checkUser;a.isLogin&&n()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.focusTimer),this.focusTimer=null,this.loginModal=null}},{key:"startTransitionAnimation",value:function(){var e=this;return new i.default(function(t){if(e.loginModal=document.querySelector(".login-modal"),e.loginModal){var a=e.loginModal.classList;a.add("login-rollout");var n=function n(){t(),a.contains("login-rollout")?(a.remove("login-rollout"),a.add("login-rollin")):(a.remove("login-rollin"),e.loginModal.removeEventListener("animationend",n),e.loginModal.removeEventListener("webkitAnimationEnd",n))};e.loginModal.addEventListener("animationend",n),e.loginModal.addEventListener("webkitAnimationEnd",n)}else t()})}},{key:"render",value:function(){var e=this,t=this.props,a=t.intlr,i=t.account,s=this.state,u=s.emailNum,c=s.validateStatus,d=s.errorMsg;return g.default.createElement(n.default,{visible:!0,title:this.renderTitle(),width:"100%",zIndex:990,maskClosable:!1,mask:!0,keyboard:!1,onCancel:this.handleCancel,footer:null,className:"small-modal login-modal",ref:this.setLoginModal},g.default.createElement(o.default,{onSubmit:this.handleNext,className:"login-form"},g.default.createElement(o.default.Item,{validateStatus:c,help:d},g.default.createElement(r.default,{ref:function(t){return e.saveEl(t)},value:u,placeholder:a.messages[(0,I.isInternational)()?"FORM.FIELD.EMAIL":"FORM.FIELD.EMAIL.PH"],onChange:this.handleChange})),g.default.createElement(o.default.Item,null,g.default.createElement(l.default,{type:"primary",htmlType:"submit",disabled:!u||d,className:"login-form-button",style:{width:"100%"},loading:i.checkEmailNumRequest===E.default.PENDING},a.messages["BUTTON.NEXT.TEXT"])),g.default.createElement(T.default,{isInternational:(0,I.isInternational)()}),g.default.createElement("p",{className:"emailNum-form-link"},(0,I.isInternational)()?g.default.createElement("a",{onClick:function(e){return k.default.openLink(e,N.default.link.mblock_web.zh)}},a.messages["ACCOUNT.SWITCH.TO"]," 慧编程"):g.default.createElement("a",{onClick:function(e){return k.default.openLink(e,N.default.link.mblock_web.en)}},a.messages["ACCOUNT.SWITCH.TO"]," mBlock International"))))}}]),t}(g.default.Component);t.default=(0,h.connect)(function(e){return{intlr:e.intlr,account:e.account}},function(e){return{checkUser:function(){return e(p.default.getUserState())},submit:function(t,a,n){return e(p.default.checkEmailNum(t,a,n))},changeMode:function(t){return e(p.default.changeMode(t))}}})(o.default.create()(S))}}]);