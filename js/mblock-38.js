(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{474:function(e,t){},836:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=C(a(28)),r=C(a(73)),s=C(a(22)),n=C(a(80)),o=C(a(77)),u=C(a(27)),i=C(a(3)),c=C(a(9)),d=C(a(2)),f=C(a(7)),m=C(a(5)),p=C(a(6)),g=C(a(1)),E=a(14),S=a(90),R=C(a(87)),h=C(a(266)),O=C(a(72)),D=C(a(88)),b=a(18),F=C(a(16)),M=a(32),v=C(a(35)),N=a(166),w=C(a(82));a(474);var P=C(a(81));function C(e){return e&&e.__esModule?e:{default:e}}var T=function(e){function t(e){(0,d.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return a.handleCancel=function(){F.default.replace((0,b.parseRoute)("/"))},a.handleBack=function(){switch(a.props.match.params.type){case"registerPwd":(0,M.isInternational)()?F.default.replace((0,b.parseRoute)("/agreement")):F.default.replace((0,b.parseRoute)("/login"));break;case"loginPwd":F.default.replace((0,b.parseRoute)("/login"));break;case"deletePwd":F.default.replace((0,b.parseRoute)("/profile"));break;default:F.default.replace((0,b.parseRoute)("/"))}},a.handleLogin=function(e){e.preventDefault();var t=a.props,l=t.account,r=void 0===l?{}:l,s=t.form,n=t.login,o=r.emailNum;s.validateFields(function(e,t){e||n((0,i.default)({account:o},t),a.loginSuccessCb.bind(a),a.loginFailCb.bind(a))})},a.loginSuccessCb=function(){b.showSuccessMessage.call(a,"USER.LOGIN.SUCCESS.MSG"),F.default.replace((0,b.parseRoute)("/"));var e=a.props,t=e.project,l=e.intlr,r=e.confirmName,s=l.messages,n=t.name;P.default.setProjectPlatformType(t.projectId),-1===n.indexOf(s["FILENAME.EMPTY"])?(r(!0),(0,N.setProjectname)(w.default)):r(!1)},a.loginFailCb=function(e){if(99999!==e.code){var t=a.props,l=t.intlr,r=t.account;t.form.setFields({password:{errors:[new Error(/^[0-9a-zA-Z]*$/g.test(r.emailNum)?l.messages["FORM.FIELD.PASSWORD.CONTACT.MSG"]:l.messages["FORM.FIELD.PASSWORD.OLD.MSG"])]}})}else b.showErrorMessage.call(a,"MSG.99999")},a.handleRegister=function(e){e.preventDefault();var t=a.props,l=t.account,r=void 0===l?{}:l,s=t.form,n=t.register,o=r.emailNum;s.validateFields(function(e,t){e||n((0,i.default)({email:o},t),a.registerSuccessCb.bind(a),a.registerFailCb.bind(a))})},a.registerSuccessCb=function(){b.showSuccessMessage.call(a,"USER.REGISTER.SUCCESS.MSG"),F.default.replace((0,b.parseRoute)("/"))},a.registerFailCb=function(e){99999!==e.code?b.showErrorMessage.call(a,"USER.REGISTER.FAIL.MSG",e.code):b.showErrorMessage.call(a,"MSG.99999")},a.handleDelete=function(e){if(e.preventDefault(),a.isSocial())a.deleteSuccessCb();else{var t=a.props,l=t.account,r=void 0===l?{}:l,s=t.form,n=t.saveOldPwd,o=r.data,u=(void 0===o?{}:o).email;s.validateFields(function(e,t){if(!e){var l=t.password;n({email:u,oldpassword:l},a.deleteSuccessCb.bind(a),a.deleteFailCb.bind(a))}})}},a.deleteSuccessCb=function(){F.default.replace((0,b.parseRoute)("/profile/delete"))},a.deleteFailCb=function(e){if(99999!==e.code){var t=a.props,l=t.intlr;t.form.setFields({password:{errors:[new Error(l.messages["FORM.FIELD.PASSWORD.OLD.MSG"])]}})}else b.showErrorMessage.call(a,"MSG.99999")},a.renderTitle=function(e){return g.default.createElement("div",{className:"pwd-title title-tac"},g.default.createElement("button",{"aria-label":"Back",className:"ant-btn-back",onClick:a.handleBack},g.default.createElement(u.default,{type:"left"})),a.getTitle(e))},a.getTitle=function(e){var t=a.props.intlr;switch(e){case"registerPwd":return t.messages["USER.CREATE.ACCOUNT"];case"loginPwd":return t.messages["USER.EMAIL.LOGIN"];case"deletePwd":return t.messages["USER.DELETE"];default:return null}},a.renderContent=function(e){switch(e){case"registerPwd":return a.renderRegister();case"loginPwd":return a.renderLogin();case"deletePwd":return a.renderDelete();default:return null}},a.renderRegister=function(){var e=a.props,t=e.form,l=e.intlr,r=e.account,u=t.getFieldDecorator,i="zh"===l.langKey?h.default.ZH_PROTOCOL:h.default.FN_PROTOCOL;return g.default.createElement(n.default,{onSubmit:a.handleRegister,className:"login-form"},g.default.createElement("p",{className:"emailNum-section"},r.emailNum),g.default.createElement(n.default.Item,null,u("password",{rules:[{min:6,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MSG"]},{max:20,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MSG"]},{required:!0,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MSG"]}]})(g.default.createElement(o.default,{ref:function(e){return a.focusEl=e},type:"password",autoComplete:"true",placeholder:a.props.intlr.messages["FORM.FIELD.PASSWORD.PH"]}))),g.default.createElement(n.default.Item,null,g.default.createElement(s.default,{type:"primary",htmlType:"submit",style:{width:"100%"},className:"login-form-button col auto-width-col",disabled:a.hasDisableBtn(),loading:r.registerRequest===R.default.PENDING},l.messages["USER.CREATE.ACCOUNT"])),g.default.createElement("p",{className:"user-links",style:{textAlign:"center"}},l.messages["REGISTER.AGREE"],g.default.createElement("a",{href:i,rel:"noopener noreferrer",target:"_blank",onClick:function(e){return v.default.openLink(e,i)}},l.messages["PROTOCOL.TEXT"])))},a.renderLogin=function(){var e=a.props,t=e.form,l=e.intlr,r=e.account,u=void 0===r?{}:r,i=t.getFieldDecorator;return g.default.createElement(n.default,{onSubmit:a.handleLogin,className:"login-form"},g.default.createElement("p",{className:"emailNum-section"},u.emailNum),g.default.createElement(n.default.Item,null,i("password",{rules:[{min:6,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MIN.MSG"]},{max:20,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MAX.MSG"]},{required:!0,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MSG"]}]})(g.default.createElement(o.default,{ref:function(e){return a.focusEl=e},type:"password",autoComplete:"true",placeholder:a.props.intlr.messages["FORM.FIELD.PASSWORD.PH"]}))),g.default.createElement(n.default.Item,null,g.default.createElement(s.default,{type:"primary",htmlType:"submit",className:"login-form-button",style:{width:"100%"},disabled:a.hasDisableBtn(),loading:u.loginRequest===R.default.PENDING},l.messages["BUTTON.LOGIN.TEXT"])),!/^[0-9a-zA-Z]*$/g.test(u.emailNum)&&g.default.createElement("p",{className:"user-links title-tac"},g.default.createElement(S.Link,{to:(0,b.parseRoute)("/forget"),rel:"noopener noreferrer",replace:!0},l.messages["FORGET.PASSWORD"])))},a.renderDelete=function(){var e=a.props,t=e.form,l=e.intlr,r=e.account,u=void 0===r?{}:r,i=u.data,c=void 0===i?{}:i,d=t.getFieldDecorator;return g.default.createElement(n.default,{onSubmit:a.handleDelete,className:"login-form"},g.default.createElement("p",{className:"emailNum-section"},c.email),a.isSocial()?null:g.default.createElement(n.default.Item,null,d("password",{rules:[{min:6,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MIN.MSG"]},{max:20,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MAX.MSG"]},{required:!0,message:a.props.intlr.messages["FORM.FIELD.PASSWORD.MSG"]}]})(g.default.createElement(o.default,{ref:function(e){return a.focusEl=e},type:"password",autoComplete:"true",placeholder:a.props.intlr.messages["FORM.FIELD.PASSWORD.PH"]}))),g.default.createElement(n.default.Item,null,g.default.createElement(s.default,{type:"primary",htmlType:"submit",className:"login-form-button",style:{width:"100%"},disabled:a.hasDisableBtn(),loading:u.loginRequest===R.default.PENDING},l.messages["BUTTON.NEXT.TEXT"])))},a.state={},a.focusEl=null,a.focusTimer=null,a}return(0,p.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.match,l=t.account,r=void 0===l?{}:l,s=t.checkUser,n=r.data,o=void 0===n?{}:n;r.isLogin&&"deletePwd"!==a.params.type&&s(),r.emailNum||o.email||F.default.push((0,b.parseRoute)("/login")),this.focusTimer=setTimeout(function(){e.focusEl&&e.focusEl.focus()})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.focusTimer),this.focusTimer=null}},{key:"isSocial",value:function(){var e=this.props.account.data,t=e.isBindFacebook,a=e.isBindGoogle;return void 0===t&&(t=!1),void 0===a&&(a=!1),JSON.parse(t)||JSON.parse(a)}},{key:"hasDisableBtn",value:function(){if(this.isSocial())return!1;var e,t=this.props.form,a=t.getFieldsError;return!(0,t.isFieldTouched)("password")||(e=a(),(0,r.default)(e).some(function(t){return e[t]}))}},{key:"render",value:function(){var e=this.props.match.params.type;return g.default.createElement(l.default,{visible:!0,title:this.renderTitle(e),width:"100%",className:"small-modal",closable:!1,maskClosable:!1,keyboard:!1,onCancel:this.handleCancel,footer:null},this.renderContent(e))}}]),t}(g.default.Component);t.default=(0,E.connect)(function(e){return{intlr:e.intlr,account:e.account,project:e.project}},function(e){return{register:function(t,a,l){return e(O.default.register(t,a,l))},login:function(t,a,l){return e(O.default.login(t,a,l))},saveOldPwd:function(t,a,l){return e(O.default.saveOldPwd(t,a,l))},checkUser:function(){return e(O.default.getUserState())},confirmName:function(t){return e(D.default.saved({isConfirmName:t}))}}})(n.default.create()(T))}}]);