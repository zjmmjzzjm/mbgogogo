(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{821:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=R(a(22)),r=R(a(28)),l=R(a(80)),s=R(a(164)),u=R(a(23)),i=R(a(25)),d=R(a(38)),c=R(a(9)),o=R(a(2)),f=R(a(7)),E=R(a(5)),h=R(a(6)),p=R(a(1)),m=a(14),T=R(a(16)),v=R(a(15)),C=R(a(263)),g=a(18),A=R(a(19));function R(e){return e&&e.__esModule?e:{default:e}}var D=function(e){function t(e){(0,o.default)(this,t);var a=(0,E.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));y.call(a);var n=(0,g.getQueryString)(T.default.location.search,"deviceId")||v.default.DEVICE.CODEY,r=(0,g.getQueryString)(T.default.location.search,"name"),l=(0,g.getQueryString)(T.default.location.search,"tag")||"online";a.state={version:null,device:n,name:r,tag:l};var s=a.props.intlr;return a.hasConnected()||(d.default.warn(s.messages["UPDATER.FRIMWARE.NOTCONNECT"]),T.default.replace("/")),a}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){var e=(0,i.default)(u.default.mark(function e(){var t,a,n,r,l;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasConnected()){e.next=2;break}return e.abrupt("return");case 2:if(t=this.props,a=t.updater,n=t.setFirmware,r=t.intlr,l=a.model,this.state.device!==v.default.DEVICE.MCORE){e.next=8;break}return n({tag:this.state.tag}),this.setState({version:r.messages["UPDATE.FACTORY.DATA.LATEST"]}),e.abrupt("return");case 8:if(this.state.device!==v.default.DEVICE.AURIGA){e.next=12;break}return n({tag:this.state.tag}),this.setState({version:r.messages["UPDATE.FACTORY.DATA.LATEST"]}),e.abrupt("return");case 12:l.codey&&!l.codey.last||this.setState({version:l.codey.last});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.intlr,t=this.state,a=t.version,n=t.tag,u=t.device;return p.default.createElement(r.default,{width:"100%",className:"small-modal",visible:!0,title:e.messages["UPDATER.FRIMWARE.M.TITLE"],keyboard:!1,maskClosable:!1,onCancel:this.handleCancel,footer:this.footer()},p.default.createElement(l.default,{layout:"vertical"},p.default.createElement(l.default.Item,{label:e.messages["UPDATER.FRIMWARE.F.DEVICE.TEXT"]},p.default.createElement(s.default,{defaultValue:u,disabled:!0},p.default.createElement(s.default.Option,{value:"codey"},e.messages.CODEY))),p.default.createElement(l.default.Item,{label:e.messages["UPDATER.FRIMWARE.F.VERSION.TEXT"]},p.default.createElement(s.default,{value:n,onChange:this.handleChange,disabled:!0},p.default.createElement(s.default.Option,{value:"online"},a),p.default.createElement(s.default.Option,{value:"reset"},e.messages["UPDATE.FACTORY.DATA.RESET"])))))}}]),t}(p.default.Component),y=function(){var e=this;this.hasConnected=function(){var t=e.props.connect;return t&&t.status===v.default.CONNECT_STATUS.CONNECT_SUCCESS},this.handleCancel=function(){A.default.emit("firmware.update.cancel",e.state.device),T.default.replace("/")},this.handleUpdate=function(){var t=e.state,a=t.device,n=t.name,r=t.tag;T.default.replace("/updater/firmware/progress?name="+n+"&tag="+r+"&device="+a)},this.handleChange=function(t){e.setState({tag:t})},this.footer=function(){var t=e.props.intlr;return[p.default.createElement(n.default,{key:"serial",onClick:e.handleCancel},t.messages["BUTTON.CANCEL.TEXT"]),p.default.createElement(n.default,{key:"connect",type:"primary",onClick:e.handleUpdate},t.messages["BUTTON.UPDATE.TEXT"])]}};t.default=(0,m.connect)(function(e){return{intlr:e.intlr,connect:e.connect,updater:e.updater}},function(e){return{setFirmware:function(t){return e(C.default.firmware(t))}}})(D)}}]);